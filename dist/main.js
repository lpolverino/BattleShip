(()=>{"use strict";const e=(e,r)=>{const t=document.createElement("td");return t.dataset.column=e,t.dataset.row=r,t.innerText="#"===e?r:"-",t},r=(r,t,n)=>{const a=document.createElement("tr");for(let o=0;o<n;o++){const n=e(t[o],r);a.appendChild(n)}return a},t=e=>{const t=document.createElement("div");t.classList.add("gameboard");const n=(()=>{const e=document.createElement("table"),t=["#","a","b","c","d","e","f","g","h","i","j"],n=(e=>{const r=document.createElement("tr");return e.forEach((e=>{const t=document.createElement("td");t.innerText=e,r.appendChild(t)})),r})(t);e.appendChild(n);for(let n=1;n<=10;n++){const a=r(n,t,11);e.appendChild(a)}return e})();return t.appendChild(n),t},n=()=>{const e=[],r=(r,t)=>!!e.some((e=>e.column===r&&e.row===t));return{attack:(t,n)=>{if(r(t,n))throw new Error("Already shooted in that position");e.push({column:t,row:n})},hasAttacked:r}},a=()=>{let e=(()=>{let e={};return["a","b","c","d","e","f","g","h","i","j"].forEach((r=>{e[r]=new Array(10).fill({ocupied:!1,receivedAttack:!1})})),e})(),r=!1;const t=e=>({ocupied:!0,ship:e}),n=(e,r,t,n)=>{((e,r,t)=>{a(r,t+e-1)})(e,r,t);const o=(e=>{if(e<1||e>4)throw new Error("Invalid length provided");const r=e;let t=0;return{length:()=>r,isSunked:()=>r===t,hit:()=>{t++}}})(e);((e,r)=>{let t=0;for(;t<e;)r(t),t++})(e,(e=>n(e,o)))},a=(r,t)=>{if(!e.hasOwnProperty(r)||t>9)throw new Error("invalid cordinate")};return{hasShip:(r,t)=>e[r][t].ocupied,deployHorizontalShip:(r,a,o)=>{n(r,a,o,((r,n)=>{e[a][o+r]=t(n)}))},deployVerticalShip:(r,a,o)=>{const d=["a","b","c","d","e","f","g","h","i","j"];let i=d.indexOf(a);n(r,a,i,((r,n)=>{e[d[i+r]][o]=t(n)}))},receiveAttack:(t,n)=>{a(t,n),e[t][n].ocupied&&(e[t][n].ship.hit(),e[t][n].ship.isSunked()&&(()=>{let r=!0;const t=e=>!e.ocupied||e.ship.isSunked();for(const n in e)r=r&&e[n].every(t);return r})()&&(r=!0)),e[t][n].receivedAttack=!0},hasBeenAtacked:(r,t)=>(a(r,t),e[r][t].receivedAttack),wippedBoard:()=>r,iterateMap:e=>null}},o=(e,r)=>{r.forEach((r=>{"Horizontal"===r.direction||1===r.direction?e.deployHorizontalShip(r.size,r.column,r.row):e.deployVerticalShip(r.size,r.column,r.row)}))},d=()=>({column:"a",row:1});!async function(){const e=()=>!!r.hasWinner()&&(i.renderGameOver(r.winner()),!0);let r=function(e,r){let t=(()=>{let e=0;return{currentTurn:()=>e+1,pass:()=>{e=(e+1)%2}}})(),i={gameboard:a(),player:n()},c={gameboard:a(),player:n()};o(i.gameboard,[]),o(c.gameboard,[]);const l=()=>i.gameboard.wippedBoard()||c.gameboard.wippedBoard(),p=()=>1===t.currentTurn();return{hasWinner:l,isPlayerTurn:p,playTurn:(e,r)=>{if(l())throw new Error("Cant play turn if the game  is over");p()?(i.player.attack(e,r),c.gameboard.receiveAttack(e,r)):(c.player.attack(e,r),i.gameboard.receiveAttack(e,r)),t.pass()},winner:()=>l()?i.gameboard.wippedBoard()?1:0:-1,gameboards:()=>({player:i.gameboard,computer:c.gameboard}),getComputerPlay:d}}(),i=function(){let e=document.getElementById("player"),r=document.getElementById("enemy");return{intialize:(n,a)=>{const o=(n.player,t()),d=(n.computer,t());e.appendChild(o),r.appendChild(d)},render:()=>{},renderGameOver:()=>{}}}();i.intialize(r.gameboards(),((t,n)=>{try{r.playTurn(t,n)}catch(e){}if(!e()){i.render(r.gameboards());const t=r.getComputerPlay();r.playTurn(t.column,t.row),e()||i.render(r.gameboards())}}))}()})();